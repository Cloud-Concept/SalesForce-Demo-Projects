<apex:page title="{!$ObjectType.Loop__DDP__c.label} Edit: New {!$ObjectType.Loop__DDP__c.label}" standardController="Loop__DDP__c" extensions="Loop.editFormExt" id="ap" recordSetVar="">
	<apex:sectionHeader title="{!$ObjectType.Loop__DDP__c.label} Edit" subtitle="New {!$ObjectType.Loop__DDP__c.label}" help="http://support.drawloop.com/loop-platform/3-create-quick-ddp/" />
	<apex:form id="af">
		<apex:outputPanel id="pageMsgs">
			<apex:pageMessages />
		</apex:outputPanel>
		<apex:pageBlock title="{!$ObjectType.Loop__DDP__c.label} Edit" mode="edit" id="pb">
			<apex:pageBlockButtons >
				<apex:commandButton value="Save and Edit Form" action="{!wizardSaveEdit}" onclick="jQuery('[id=\'ap:af:pb:processing\']').show();" rendered="{!NOT($Request.wizard='true')}" />
				<apex:commandButton value="Continue" action="{!wizardContinue}" onclick="jQuery('[id=\'ap:af:pb:processing\']').show();" rendered="{!$Request.wizard='true'}" />
				<apex:commandButton value="Save" action="{!wizardSave}" onclick="jQuery('[id=\'ap:af:pb:processing\']').show();" rendered="{!$Request.wizard='true'}" />
				<apex:commandButton value="Cancel" action="{!cancel}" />
			</apex:pageBlockButtons>
			<apex:outputPanel id="processing" layout="block" style="display: none; text-align: center;">
				<apex:image alt="processing" value="https://apps.drawloop.com/images/widgets/throbber.gif" />
			</apex:outputPanel>
			<apex:pageBlockSection title="Information">
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$ObjectType.Loop__DDP__c.label} {!$ObjectType.Loop__DDP__c.fields.Name.label}" />
					<apex:outputPanel layout="block" styleClass="requiredInput">
						<apex:outputPanel layout="block" styleClass="requiredBlock"></apex:outputPanel>
						<apex:inputField value="{!ddp.Name}" />
					</apex:outputPanel>
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$ObjectType.RecordType.label}" />
					<apex:outputText value="Form" />
				</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
			<apex:actionRegion >
			<apex:pageBlockSection title="{!$ObjectType.Loop__DDP_File__c.labelplural} - Select or upload up to 3 documents" columns="1" id="pbs">
				<apex:pageBlockTable value="{!ddpFiles}" var="d" id="docRepeat">
					<apex:column headerValue="Folder">
						<apex:actionFunction action="{!d.changeFolder}" name="change{!d.index}Folder" />
						<apex:selectList size="1" value="{!d.folderId}" id="folderList">
                			<apex:selectOptions value="{!docFolders}" />
                			<apex:actionSupport event="onchange" onsubmit="change{!d.index}Folder(); return false;" />
                		</apex:selectList>
					</apex:column>
					<apex:column headerValue="Document">
						<apex:selectList size="1" value="{!d.documentId}" id="documentList">
                			<apex:selectOption itemLabel="--Upload New--" itemValue="uploadnew" />
                			<apex:selectOptions value="{!d.documents}" />
                			<apex:actionSupport event="onchange" />
                		</apex:selectList>
					</apex:column>
					<apex:column >
                		<apex:outputPanel id="uploadPanel">
	                		<apex:inputFile id="test" value="{!d.docBody}" filename="{!d.docName}" style="{!IF(d.documentId=='uploadnew', '', 'display: none;')}" />
                		</apex:outputPanel>
					</apex:column>
				</apex:pageBlockTable>
				<!--apex:pageBlockSectionItem >
					<apex:outputLabel value="" />
					<apex:commandLink value="Add {!$ObjectType.Document.label}" action="{!addFile}" />
				</apex:pageBlockSectionItem-->
			</apex:pageBlockSection>
			</apex:actionRegion>
		</apex:pageBlock>
	</apex:form>
</apex:page>